From 6370930a8489530d6b107ddfc6915e279e3d66ff Mon Sep 17 00:00:00 2001
From: Meticulus <theonejohnnyd@gmail.com>
Date: Tue, 24 Apr 2018 09:49:33 -0500
Subject: [PATCH] charger: charger use coh led.

---
 healthd/Android.mk               | 5 +++++
 healthd/healthd_mode_charger.cpp | 3 +++
 2 files changed, 8 insertions(+)

diff --git a/healthd/Android.mk b/healthd/Android.mk
index a90f550..05ddacb 100644
--- a/healthd/Android.mk
+++ b/healthd/Android.mk
@@ -71,6 +71,7 @@ LOCAL_SRC_FILES := \
 
 LOCAL_MODULE := libhealthd_charger
 LOCAL_C_INCLUDES := bootable/recovery $(LOCAL_PATH)/include
+LOCAL_C_INCLUDES += vendor/coh/coh_linux/include
 LOCAL_EXPORT_C_INCLUDE_DIRS := \
     $(LOCAL_PATH) \
     $(LOCAL_PATH)/include
@@ -84,6 +85,8 @@ LOCAL_STATIC_LIBRARIES := \
     libcutils \
     libhealthd_draw \
     liblog \
+    libcoh_linux \
+    libcoh_common \
     libm \
     libc \
 
@@ -132,6 +135,8 @@ LOCAL_STATIC_LIBRARIES := \
     libutils \
     libcutils \
     liblog \
+    libcoh_linux \
+    libcoh_common \
     libm \
     libc \
 
diff --git a/healthd/healthd_mode_charger.cpp b/healthd/healthd_mode_charger.cpp
index 6c6d738..f17aa33 100644
--- a/healthd/healthd_mode_charger.cpp
+++ b/healthd/healthd_mode_charger.cpp
@@ -52,6 +52,8 @@
 
 #include <healthd/healthd.h>
 
+#include <coh_linux/led.h>
+
 using namespace android;
 
 char* locale;
@@ -313,6 +315,7 @@ static void update_screen_state(charger* charger, int64_t now) {
         LOGV("[%" PRId64 "] animation starting\n", now);
         if (batt_prop) {
             batt_anim->cur_level = batt_prop->batteryLevel;
+	    set_led_color_on_batterylevel(batt_prop->batteryLevel);
             batt_anim->cur_status = batt_prop->batteryStatus;
             if (batt_prop->batteryLevel >= 0 && batt_anim->num_frames != 0) {
                 /* find first frame given current battery level */
-- 
2.7.4

